# Stimulus Equivalence (SE) in a GPT model.
The code for the GPT model is based on the repository of Andrej Karpathy NanoGPT [Video lecture](https://youtu.be/kCc8FmEb1nY?si=PdtlPy1bLAQcHOsQ) [nanoGPT model.py](https://github.com/karpathy/nanoGPT/blob/master/model.py).
This is an adaptation of a typical SE experiment with the arbitrary matching to sample procedure. Each experimental trial consists of a sample stimulus, 3 comparison stimuli and the selected option response.
The experiment is adapted from a supervised learning task where the inputs are [sample, comparison_1, comparison_2, comparison_3] trials and the target is the option response. This experiment has been tested on Feed-Forward networks in this paper: [Differences of Training Structures on Stimulus Class Formation in Computational Agents](https://www.mdpi.com/2414-4088/7/4/39)

The complete sequence of each text passed to the GPT model consist of 5 tokens: [sample, comparison_1, comparison_2, comparison_3, option]. The agent must predict the option (5th token) given the 4 previous tokens.
All the stimuli and the response options are encoded as tokens. Inputs are the context tokens and the expected token is the option response. The prompt is [sample, comparison_1, comparison_2, comparison_3] and the model must return the selected option.
In the stablishment of 3 equivalence class with 4 members each, the stimulus for the class 1 are $[A_1, B_1, C_1, D_1]$; stimulus for the class 2 are $[A_2,B_2,C_2,D_2]$; and stimulus for the class 3 are $[A_3,B_3,C_3,D_3]$. Baseline relations pairs for the training phase are $[A_n-B_n, B_n-C_n, C_n-D_n]$ for each ($_n$) class.

As an example, for the training of the relation $A_1-B_1$ a trial can be $[A_1, C_3, B_1, D_2]$. The agent is trained to select the second comparison stimulus as target token "option_2". In this example, the complete sequence of tokens is $[A_1, C_3, B_1, D_2, option_2]$.
There is no train-test split in train. Baseline relations trials are passed as train data and emergent relations of reflexivity, symmetry and transitivity are passed as test data. Evaluation pairs are: reflexivity $[A_n-A_n, B_n-B_n, C_n-C_n, D_n-D_n]$; symmetry $[B_n-A_n, C_n-B_n, D_n-C_n]$ and transitivity $[A_n-C_n, A_n-D_n, B_n-D_n, C_n-A_n, D_n-A_n, D_n-B_n]$. Each trial has only one comparison related and trials groups are formed by type of relation.
